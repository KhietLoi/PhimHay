@model LoginViewModel

@{
    Layout = "_Layout";
}

<!-- THÔNG BÁO -->
@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">
        @TempData["SuccessMessage"]
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">
        @TempData["ErrorMessage"]
    </div>
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đăng nhập</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="~/css/Login.css" />
</head>
<body>
    <div class="main-content">
        <div class="container mt-5">
            <div class="form-container">
                <h2 class="text-center text-2xl font-bold mb-4">Đăng nhập</h2>

                <form method="post" class="needs-validation" novalidate>
                    @Html.AntiForgeryToken()

                    <div class="form-group">
                        <label for="Email" class="form-label">Email</label>
                        <input type="email" class="form-control @(ViewData.ModelState["Email"]?.Errors.Count > 0 ? "is-invalid" : "")" id="Email" name="Email" value="@Model?.Email" required />
                        @if (ViewData.ModelState["Email"]?.Errors.Count > 0)
                        {
                            <div class="text-danger">@ViewData.ModelState["Email"].Errors[0].ErrorMessage</div>
                        }
                    </div>

                    <div class="form-group">
                        <label for="Password" class="form-label">Mật khẩu</label>
                        <input type="password" class="form-control @(ViewData.ModelState["Password"]?.Errors.Count > 0 ? "is-invalid" : "")" id="Password" name="Password" required />
                        @if (ViewData.ModelState["Password"]?.Errors.Count > 0)
                        {
                            <div class="text-danger">@ViewData.ModelState["Password"].Errors[0].ErrorMessage</div>
                        }
                    </div>

                    <!-- General Error Display -->
                    @if (ViewData.ModelState.ContainsKey("") && ViewData.ModelState[""].Errors.Any())
                    {
                        <div class="general-error">
                            <div class="text-danger">@Html.Raw(ViewData.ModelState[""].Errors[0].ErrorMessage)</div>
                        </div>
                    }

                    <!-- Registration Link -->
                    <a href="/Account/Register" class="register-link">* Nếu chưa có tài khoản, vui lòng đăng ký?</a>
                    <div class="mt-3">
                        <a asp-action="ForgotPassword" asp-controller="Account">Quên mật khẩu?</a>
                    </div>


                    <!-- Submit Button -->
                    <button type="submit" class="btn btn-primary">Đăng nhập</button>
                </form>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script> <!-- Font Awesome for social icons -->
    <script>
        // Bootstrap form validation
        document.addEventListener('DOMContentLoaded', function () {
            const forms = document.querySelectorAll('.needs-validation');
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        });
    </script>
    <script>
        setTimeout(() => {
            document.querySelectorAll('.alert').forEach(e => e.style.display = 'none');
        }, 3000);
    </script>
</body>
</html>